# Sample Spark configuration for Azure Log Ingestion emitter using service principal with client secret.
# This is an example only. Please replace your own values where indicated.
runtime_version: '2.0' # Fabric runtime 2.0 (Spark 4.0)
spark_conf:
  # Enable Log Ingestion emitter, the emitter name can be customized, but you need to update all related configurations accordingly.
  - spark.synapse.diagnostic.emitters: LogIngestion
  - spark.synapse.diagnostic.emitter.LogIngestion.type: AzureLogIngestion

  # Log categories to emit
  # DriverLog / ExecutorLog  -> log DCR
  # EventLog                 -> event DCR
  # Metrics                  -> metric DCR
  # Meta                     -> meta DCR
  - spark.synapse.diagnostic.emitter.LogIngestion.categories: DriverLog,ExecutorLog,EventLog,Metrics

  # Data Collection Endpoint (DCE)
  - spark.synapse.diagnostic.emitter.LogIngestion.dceUri: https://<DCE_NAME>.ingest.monitor.azure.com

  # Log Analytics – Logs
  - spark.synapse.diagnostic.emitter.LogIngestion.logDcr: <LOG_DCR_ID>
  - spark.synapse.diagnostic.emitter.LogIngestion.logStream: <LOG_STREAM_NAME>

  # Log Analytics – Events
  - spark.synapse.diagnostic.emitter.LogIngestion.eventDcr: <EVENT_DCR_ID>
  - spark.synapse.diagnostic.emitter.LogIngestion.eventStream: <EVENT_STREAM_NAME>

  # Log Analytics – Metrics
  - spark.synapse.diagnostic.emitter.LogIngestion.metricDcr: <METRIC_DCR_ID>
  - spark.synapse.diagnostic.emitter.LogIngestion.metricStream: <METRIC_STREAM_NAME>

  # Log Analytics – Metadata
  - spark.synapse.diagnostic.emitter.LogIngestion.metaDcr: <META_DCR_ID>
  - spark.synapse.diagnostic.emitter.LogIngestion.metaStream: <META_STREAM_NAME>

  # Service principal authentication (SP + secret)
  - spark.synapse.diagnostic.emitter.LogIngestion.secret: <SP_CLIENT_SECRET>
  - spark.synapse.diagnostic.emitter.LogIngestion.tenantId: <SP_TENANT_ID>
  - spark.synapse.diagnostic.emitter.LogIngestion.clientId: <SP_CLIENT_ID>

  # Skip starter pools, which is needed for Log Ingestion emitter to work properly
  - spark.fabric.pools.skipStarterPools: 'true'
